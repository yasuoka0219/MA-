{% extends "base.html" %}

{% block title %}{% if template %}Edit Template{% else %}New Template{% endif %} - MA Tool{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2 class="card-title">{% if template %}Edit Template{% else %}New Template{% endif %}</h2>
    </div>
    
    <form method="POST" action="{% if template %}/templates/{{ template.id }}{% else %}/templates{% endif %}">
        <div class="form-group">
            <label for="name">Template Name *</label>
            <input type="text" id="name" name="name" required 
                   value="{{ template.name if template else '' }}"
                   placeholder="e.g., OC Reminder - 1 Week Before">
        </div>
        
        <div class="form-group">
            <label for="subject">Email Subject *</label>
            <input type="text" id="subject" name="subject" required 
                   value="{{ template.subject if template else '' }}"
                   placeholder="e.g., {{name}} Your upcoming campus visit">
            <p class="form-hint">Use variables like {% raw %}{{name}}{% endraw %} for personalization</p>
        </div>
        
        <div class="form-group">
            <label for="body_html">Email Body (HTML) *</label>
            <textarea id="body_html" name="body_html" required 
                      placeholder="Enter your email template HTML here...">{{ template.body_html if template else '' }}</textarea>
            <p class="form-hint">Supports HTML formatting and template variables</p>
        </div>
        
        <div class="preview-box">
            <h4>Available Variables</h4>
            <div class="variables-list">
                {% for v in variables %}
                <span class="variable-tag" onclick="copyVariable('{{ v.name }}')" title="{{ v.description }}">
                    {{ v.name }}
                </span>
                {% endfor %}
            </div>
            <p class="form-hint" style="margin-top: 12px;">Click to copy. Variables will be replaced with actual data when sending.</p>
        </div>
        
        <div style="margin-top: 24px; display: flex; gap: 12px;">
            <button type="submit" class="btn btn-primary">
                {% if template %}Update{% else %}Create{% endif %} Template
            </button>
            <a href="{% if template %}/templates/{{ template.id }}{% else %}/templates{% endif %}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}
